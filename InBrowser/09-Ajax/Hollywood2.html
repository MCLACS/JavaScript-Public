<!DOCTYPE html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

		<!-- Bootstrap -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

		<!-- datatables -->
		<link rel="stylesheet" href="https://cdn.datatables.net/1.10.4/css/jquery.dataTables.min.css">

	</head>


	<style>
		/* Local Styles Go Here */
		.container
		{
			margin: 50px;
		}
		#errorMsg
		{
			color: red;
			font-weight: bold;
		}
	</style>

	<body>
		<!-- HTML Goes Here... -->
		<div class="jumbotron">
			<h1 class="text-center">Hollywood!</h1>
		</div>

		<div class="container">
			<div class="form-group">
				<label for="film">Film Name</label>
				<input type="text" class="form-control"
					id="film" placeholder="Enter film name">
			</div>
			<p><input id="btn" class="btn btn-primary" type="button" value="Get Actors"/></p>

			<div id="resultsDiv" class="well">
				<h1>Results:</h1>
				<ul id="actors">
				</ul>
			</div>

			<div id="errorDiv" class="well">
				<p id="errorMsg" class="text-center"></p>
			</div>
		</div>

		<!-- jquery -->
		<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

		<!-- datatables -->
		<script src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js"></script>

		<script>


			// Local JavaScript Goes Here...

			// model...
			var model = {};
			model.actors = [];
			model.firstTime = false;
			model.errorMsg = "";

			// view ...
			function updateView()
			{
				if (model.firstTime == true)
				{
					$("#resultsDiv").hide();
					$("#errorDiv").hide();
					model.firstTime = false;
				}
				else if (model.errorMsg != undefined)
				{
					$("#resultsDiv").hide();
					$("#errorDiv").show();
					$("#errorMsg").html(model.errorMsg);
				}
				else
				{
					$("#resultsDiv").show();
					$("#errorDiv").hide();
					$("#actors").empty();
					for (var index in model.actors)
					{
						var actor = model.actors[index];
						$("#actors").append("<li>"+
							actor.first_name+ " "+actor.last_name+
							" - "+
							actor.title+
							"</li>");
					}
				}
			}

			// controller ...
			$(document).ready(function ()
			{
				model.firstTime = true;
				model.actors = [];
				updateView();
		  	});

			$("#btn").click(function ()
			{
				var f = $("#film").val();
				var url = "https://php-csci343.rhcloud.com/SP16/Assignments/Hollywood.php?cmd=actors&filmName="+f;
  			  	var request = $.getJSON(url);

				request.done(function(json)
  			    {
  				  console.log(json);
  				  model.actors = json;

				  model.errorMsg = undefined;
				  if (model.actors.length == 0)
			  	  {
				  	model.errorMsg = "No Results Found!";
				  }
				  else if (model.actors.length > 40)
				  {
				  	model.errorMsg = "To Many Results. Narrow Your Search Button Head!";
				  }
  				  updateView();
  			    });

  			  request.fail(function() {
  		          console.log( "error" );
  		      });

			});


		</script>

	</body>
</html>
